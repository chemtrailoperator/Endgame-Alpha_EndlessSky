# Copyright (c) 2025 by ChemtrailOperator
#
# Endless Sky is free software: you can redistribute it and/or modify it under the
# terms of the GNU General Public License as published by the Free Software
# Foundation, either version 3 of the License, or (at your option) any later version.
#
# Endless Sky is distributed in the hope that it will be useful, but WITHOUT ANY
# WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
# PARTICULAR PURPOSE. See the GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License along with
# this program. If not, see <https://www.gnu.org/licenses/>.

mission "Endgame Alpha 3.0"
	landing
	source
		government Republic Syndicate "Free Worlds" Hai
		not attributes ccor rim
	to offer
		has "event: EA campaign restart timer"
	on offer
		conversation
			action
				event "EA Citadelle Takeover"
				event "EA Alpherg Takeover" 2
				event "EA Fumalsamakah Takeover" 1
			`As you land on <origin>, you notice a stir over the entire city. All the screens in the spaceport and all the raido stations are saying the same thing: War on the Rim.`
			`	The reports vary widely in specifics, but you put together that the pirate planets far out on the Rim are under attack by an unknown foe. Starting yesterday, refugees flooded out of Citadelle and fled to neighboring systems or to Free Worlds space. No communications have been received out of Citadelle, and the surrounding systems are now under attack.`
			`	While the media and individuals speculate wildly about who attacked the system, you suspect you already know what's behind it.`
				decline
		
mission "Endgame Alpha 3.1"
	landing
	source
		government Republic Syndicate "Free Worlds" Hai
		not attributes ccor
	to offer
		has "event: EA Citadelle Takeover"

	on offer
		conversation
			action
				event "EA Belenos Takeover"
				event "EA Thuban Takeover"
				event "EA Men Frontline"
			`The <origin> spaceport is packed almost to maximum capacity with people buying ammunition and stockpiling equipment. The holovid screens display news networks that announce that the Belenos and Thuban systems have fallen and that Men is under heavy attack. They also mention that the takeover has happened with extreme rapidity due to the Free Worlds' reluctance and the Republic's outright refusal to offer aid to the pirate systems.`
				decline

mission "Endgame Alpha 3.2"
	landing
	clearance
	name "Defend Men"
	destination "Thule"
	description "Travel to <destination> in <system> to defend against the Alpha attack."
	source
		government Republic Syndicate "Free Worlds" Hai
		not attributes "south pirate"
	to offer
		has "event: EA Men Frontline"
	on offer
		conversation
			`As you update your commlink to the <origin> cache, a maximum priority message pops up, from Republic Navy central command. It reads:`
			`	Effective immediately. All units on non-essential deployments must report to Thule in the Men system for combat operations. All squadrons currently refitting must deploy immediately with any combat ready ships.`
				accept
	on enter "Men"
		dialog `The system is one massive battleground. Probably best to get on Men immediately to report to command.`
	npc
		personality staying
		government "Republic"
		fleet "Large Republic" 5
		fleet "Small Republic" 10
		system Men
	npc
		personality staying
		government "Free Worlds"
		fleet "Large Militia" 5
		fleet "Small Militia" 5
		system Men
	npc
		personality staying
		government "Alpha"
		fleet "Large CCOR Alpha" 2
		fleet "Large Independent Alpha" 2
		fleet "Large Syndicate Alpha" 2
		fleet "Large Southern Pirates Alpha" 2
		fleet "Small Republic Alpha" 2
		fleet "Large Republic Alpha" 2
		fleet "Pirate Raid Alpha" 
		fleet "Marauder fleet I Alpha" 
		fleet "Marauder fleet II Alpha" 
		fleet "Marauder fleet III Alpha" 
		fleet "Marauder fleet IV Alpha"
		fleet "Marauder fleet V Alpha"
		fleet "Marauder fleet VI Alpha"
		fleet "Marauder fleet VII Alpha"
		fleet "Marauder fleet VIII Alpha"
		fleet "Marauder fleet IX Alpha"
		fleet "Marauder fleet X Alpha"
		system Men

mission "Endgame Alpha 3.3"
	landing
	source Thule
	name "Defend Thule"
	description "Defend Thule in the Men system from an incoming Alpha armada."
	destination Solace
	to offer
		has "Endgame Alpha 3.2: done"
	on offer
		conversation
			`Anything civilian in the Thule spaceport has been removed or modified for military use. You notice that besides the organized Republic units, there is are many militia fleets and pirate bands operating under the direction of the Navy. Apparently an Alpha attack is enough to make normal humans put aside their differences.`
			`	Suddenly, a siren starts to blare and ships begin taking off, charging their shields as soon as they are clear of the ground. The siren is followed by a voice stating that a massive armada has been detected en route to the system and formation orders will be sent out by spaceport departure control.`
				launch
	npc
		personality entering staying target
		government "Alpha"
		system Men
		fleet "Large CCOR Alpha" 2
		fleet "Large Independent Alpha" 2
		fleet "Large Syndicate Alpha" 2
		fleet "Large Southern Pirates Alpha" 2
		fleet "Small Republic Alpha" 2
		fleet "Large Republic Alpha" 2
		fleet "Pirate Raid Alpha" 2
		fleet "Marauder fleet I Alpha" 2
		fleet "Marauder fleet II Alpha" 2
		fleet "Marauder fleet III Alpha" 2
		fleet "Marauder fleet IV Alpha" 2
		fleet "Marauder fleet V Alpha" 2
		fleet "Marauder fleet VI Alpha" 2
		fleet "Marauder fleet VII Alpha" 2
		fleet "Marauder fleet VIII Alpha" 2
		fleet "Marauder fleet IX Alpha" 2
		fleet "Marauder fleet X Alpha" 2
		fleet "Omega Guardian" 4
		on destroy
			dialog `As the last of the Alpha ships is destroyed, the Republic flagship hails you: "We've defeated this wave, but if anything I've heard about the Alphas is true there will be more. Retreat to Solace to regroup."`
	npc
		system Men
		personality launching heroic
		government "Republic"
		fleet "Large Republic" 2
		fleet "Small Republic" 4
	npc
		system Men
		personality launching heroic
		government "Free Worlds"
		fleet "Large Militia" 3
		fleet "Small Militia" 3
	npc
		system Men
		personality launching
		government "Independent"
		fleet "Large Independent" 2
	npc
		personality launching
		government Republic
		system Men
		ship "Cruiser" "R.N.S. Everest"
		on destroy	
			dialog `The flagship of the Republic fleet hails you: "We can't possibly resist this! Get to Solace and regroup-" The transmission abruptly cuts off as the ship explodes.`
	on complete
		event "EA Men Takeover"
		event "EA Beta Lupi Takeover"
		event "EA Pherkad Frontline"
		event "EA Kappa Centauri Frontline"
		conversation
			`The number casualties is saddening. Barely any of the original group of ships land with you on Solace.`
			`	The spaceport controllers tell you that you are requested at the joint headquarters in the spaceport.`

mission "Endgame Alpha 3.4"
	priority
	source Solace
	name "Investigate Alpha Incursion"
	description "Search the Citadelle system, as well as Alvorada, for signs of where the Alpha incursion began."
	destination Alvorada
	clearance
	to offer
		has "Endgame Alpha 3.3: done"
	on offer
		conversation
			`The "Joint Headquarters" appears to be staffed mostly by the Republic, probably becaues the Free Worlds does not yet have the capability to deploy on such a scale. You are ushered past a line of waiting staff officers into the main office, where Raven, several Republic admirals, Free Worlds officers, and officials are seated.`
			`	One of the admirals begins speaking: "I've got several disturbing pieces of information for you, first, the defense in Men collapsed under another wave of attacks shortly after you left, and we are being pressured rather hard here now so for now Beta Lupi is off limits as well. Second, the Alpha force, far more powerful than anything we suspected, was accompanied by unique battleships equipped with jump drives that seem to be cobbled together from various large ships, some of which even I've never seen. They are far more powerful than any individual ship we have and will probably end up being a problem. Third, and probably most unsettling, is that new intelligence reports from Bailey informed us that the attack did not originate from there; it came from off planet, though they don't know whether the invasion force jumped from a neighboring system or took off from Alvorada. Do you have any questions about that?"`
			choice
				`	"What does this have to do with me?"`
			`	"That's what I'm getting to, commander. You have a wide range of experience in things beyond the reaches of human space. Raven has recommended that you be selected to attempt penetrating captured territory to investigate Citadelle. Since it is beyond the purview of Navy regulations, I will not force you, but you are the most likely candidate."`
			choice
				`	"You must be crazy to think I'd try to break into that!"`
					goto crazy
				`	"I'll try, but no guarantees."`
					goto okay
			label crazy
			`	The speaker looks disappointed, some of the civilian officials mutter to each other, and somehow Raven's stoic attitude seems let down.`
			`	"Understood, sir. We will find somebody else to complete the job. Your duties for now will be to hold the defensive lines here and in Kappa Centauri. I can order you to do that."`
				decline
			label okay
			`	The whole group takes a metaphorical sigh of relief. The admiral says, "Well then, good luck! Oh, one last thing, commander, make sure to carry enough fuel for the round trip. Given the activity we've seen hanging around with a ramscoop might not be feasible."`
				accept

mission "Endgame Alpha 3.5"
	landing
	name "Investigate Alpha Incursion"
	description "Investigate the Citadelle system for signs of where the Alphas came from, and then return to Solace."
	destination Solace
	source Alvorada
	to offer
		has "Endgame Alpha 3.4: done"
	on offer
		conversation
			`Although the system is full of traffic, the planet is messily guarded, and slipping underneath the completely uncoordinated patrols is easy. Activity goes down as you get closer to the surface, indicating that the Alphas aren't very interested in this planet. After a few orbits it becomes clear that the Alphas never had a significant force here.`
			`	Eventually, you are detected by an Alpha ship, but it flies straight towards you without signallng to any other ships.`
				launch
	npc
		government "Alpha"
		personality vindictive target unconstrained
		ship "Marauder Raven" "Saber of Filth"

	on enter "Citadelle"
		dialog "As your sensor systems complete their scan of the system, you notice that the usually empty space beyond Citadelle is registering some disturbances."

mission "Endgame Alpha 3.6"
	landing
	source Solace
	name "Navy Patrol"
	description "Patrol the Beta Lupi, Kappa Centauri, and Pherkad systems, and return to Solace for payment"
	destination Solace
	waypoint "Beta Lupi"
	waypoint "Kappa Centauri"
	to offer
		has "Endgame Alpha 3.5: done"
	on offer
		payment 2000000
		conversation
			`Back on Solace, you report back to Joint Headquarters at the spaceport. No one appears to be available except Raven, who opens by handing you a credit chip for two million credits.`
			`	"Well, <last>, I am intrigued by your sensor logs. The disturbances you registered on the edge of the Citadelle system are similar to those we have detected in the systems surrounding Deneb prior to the Pug attack, as if a new hyperlink is being established."`
			choice
				`	"Does that mean that there is a system beyond Citadelle?"`
					goto system
				`	"So the Alphas came from there and pretty soon they are going to have unlimited access."`
					goto access
				`	"If the hyperlink is being established now, how did they get here?"`
					goto hyperlink
				`	"Interesting..."`
					goto interesting
			label system
			`	"There is a small star nearby, but it didn't have a hyperlane to it and nobody has done much work looking into it. Kind of like Zubenelhakrabi, actually."`
			label access
			`	"If they really did come from there, it could become a worse problem than it already is. Oh, that reminds me." She pulls out a data pad.`
			label hyperlink
			`	"The ships that attacked men were unique, but they were not entirely new. After examining the logs more thoroughly we found that they are merely pieced together from many smaller ships, with materials from many of the species they have had prior contact with. They also use a mix of alien technology on board, which gives them an edge over us. They carry an astonishing compliment of fighters and drones on baord, and probably some bigger ships as well, which would make it easy for the Alphas to equip a few of these with jump drives and take over a disorganized pirate planet, and base their attacks from there."`
				goto patrol
			label interesting
			`	Raven looks at you oddly, "Yes... very."`
			label patrol
			`	"We'll continue looking into the phenomenon and the Alpha ships. Meanwhile, I have been told to give you your orders," She hands you another data pad and walks away.`
			`	The orders state that you are supposed to patrol the Kappa Centauri, Beta Lupi, and Pherkad systems, and return to Pherkad when completed.`
				accept

mission "Endgame Alpha 3.7"
	landing
	source Solace
	destination "New Iceland"
	name "Package Courier"
	description "Deliver a package to the Navy forward operating base on New Iceland."
	to offer
		has "Endgame Alpha 3.6: done"
	on offer
		payment 30000
		dialog `Upon checking back into the headquarters, you are paid 30,000 credits and given a package to deliver to the New Iceland Navy FOB.`
		event "EA Kappa Centauri Takeover"
		event "EA Pherkad Takeover" 1
		event "EA Yed Prior Frontline" 1
		event "EA Alniyat Frontline" 2
	on enter "Aldhibain"
		dialog `As you enter Aldhibain, an alert goes out to all ships in the system. "All ships be advised, defenses have fallen in and around Solace. Communications and non-military traffic has ceased."`
	on complete
		conversation
			`After you deliver the package to Navy Intelligence, you are instructed to report to the command information center in the spaceport. Multiple news broadcasts are also stating that the Alpha presence has captured Kappa Centauri and Pherkad, and the surrounding systems are now being pushed hard.`

mission "Endgame Alpha 3.8"
	priority
	name "Relief to Winter"
	description "Penetrate Alpha blockade around the Yed Prior system and carry a group of refugees back."
	source "New Iceland"
	stopover "Winter"
	passengers 4
	to offer
		has "Endgame Alpha 3.7: done"
	on offer 
		conversation
			`When you enter the command information center, you are directed to a prefab shelter set up in the middle of the food court with a hand-made sign on the zipper door that says "High Command" in permanent marker. When you enter the makeshift office, you see that Admiral Alzaga is in charge.`
			choice
				`	(Salute and say "Commander <last>, reporting as ordered, sir.")`
					goto easypsalute
				`	(Sit down)`
					goto easypsit
			label easypsalute
			`	You snap to attention and salute, but as you bring your arm up you hit a rope running past your right ear that you did not see in the dimness. The entire selter collapses in on you.`
			`Upon extracating yourself and the Admiral (blaspheming the lack of stakes in polished concrete) from the wreckage, he tells you that Winter in the Yed Prior system is under siege by the Alphas, and orders you to get through the blockade and rescue as many people as possible, as well as several dignitiaries, scientists, intelligence operators, and data analysts who would be priceless to the Alphas.`
				accept
			label easypsit
			`	"Since you don't seem to be aware of the customs and courtesies of the navy, I'll waive the usual stuff. Winter has been blockaded by the Alphas, and there are several people on Winter that would be priceless to them, including Ijs Springborn, whom I believe you have already met. Please rescue as many people as you can beyond the list that is currently being uploaded to your ship's computer. If you have  ajump drive to bypass the blockade, that would be excellent."`
				accept
	on stopover
		event "EA Yed Prior Takeover"
		event "EA Alniyat Takeover"
		event "EA Graffias Takeover" 1
		event "EA Antares Takeover" 1
		event "EA Han Takeover" 2
		event "EA Dschubba Frontline" 1
		event "EA Aldhibain Frontline" 2
		event "EA Atria Frontline" 2
		event "EA Lesath Frontline" 2
		conversation
			`	You land at the now mostly wrecked spaceport on Winter, and collect the people who were somehow told of your arrival even without using the hyperspace relays connected to Pherkad.`
			`	Everybody scrambles on board your ship as the few remaining Navy ships begin to give ground. The alphas penetrate the crumbling defensive line and begin firing at will onto the surface of the planet, blowing up anything that moves and forcing you to take off or be destroyed.`
				launch
	npc
		system "Yed Prior"
		government "Republic"
		personality staying heroic
		fleet "Large Republic" 2
		fleet "Small Republic" 2
	npc
		system "Yed Prior"
		government "Alpha"
		personality staying vindictive ramming daring
		fleet "Large Independent Alpha" 7
		fleet "Large CCOR Alpha" 7

mission "Endgame Alpha 3.8.1"
	name "Purcahse Insignia"
	source "New Iceland"
	destination "Earth"
	description "Travel to Earth in the Sol system to purchase captain insignia and receive your license."
	to offer
		has "Endgame Alpha 3.8: done"
	on offer
		conversation
			`When you land, Alzaga comes to you instead of you going to Alzaga.`
			choice
				`	(Salute him and say, Good afternoon, sir.)`
			`	"Still technically morning according to UTC." he says, "You've been approved for a commission to captain and a bonus of three million credits. I would recommend going to Earth and buying the appropriate acoutrements. Don't worry about the Alphas for now. There was a massive push of Alpha ships, but they seem to have lost steam after conquering the last few systems and they seem to be holding. The captured planets aren't doing too well, but both the Free Worlds and teh Repblic have agreed that it would be impossible to try to stop them right now."`
				accept
	on complete
		payment 3000000
		event "EA navy commission captain"
		event "EA parlribbon award"
		event "EA alphacontact award"
		event "EA pugservice award"

mission "Endgame Alpha 3.9"
	destination "New Iceland"
	name "Urgently Report to New Iceland"
	description "Travel to New Iceland in the Kaus Borealis system to receive orders."
	landing
	deadline 6
	source "Earth"
	to offer
		has "Endgame Alpha 3.8.1: done"	
	on offer
		conversation
			`You receive a message on your communication system.`
			choice
				`	(Open the message.)`
			`	"You are hereby required and directed to travel to New Iceland and report to the commanding officer of that base with the utmost dispatch. You will answer the contrary at your peril."`
				accept

mission "Endgame Alpha 3.10"
	landing
	name "Escort Refugess to Farseer"
	description "Convoy a group of refugees to Farseer in the Kursa system."
	destination "Farseer"
	to offer
		has "EA alpha FW takeover: done"
	on offer
		event "EA republic mobilized"
		conversation
			`Admiral Alzaga meets you at your ship looking extremely worried. "It's worse than we expected, much worse, the Alphas have finished establishing their hyperlink to Citaddelle and are pushing harder than ever. Losses have been extremely high and the Alphas have many more ships than we thought possible. Working in conjunction with the Militia, we hope to set up defensive positions in the few choke points we have available, here, Zubenelgenubi, Kaus Australis, Albireo, and Vindemiatrix.`
			choice
				`	"That sounds stupid, sir."`
				`	"Why are we pulling back that far?"`
					goto eartkwhy
			`"I know it does but pulling that far back seems reasonable considering the forces at play here. We can't hold them off until we get reinforcements from up north and the Deep, but the Alphas will likely push the advantage they have now and drive us back to the systems I mentioned. We are evacuating as fast as we possibly can and your next orders are to escort a fleet of refugees to Farseer in the Kursa system. Can you leave immediately?"`
				goto eartkcanyouleave
			label eartkwhy
			`	Admiral Alzaga looks at you quizzically. "I don't think I've brought you to a good enough understanding of the magnitude of the Alpha fleets, they are as powerful as the largest of the Republic and they easily outgun the Free Worlds. We can't hold them off until we get reinforcements from up north and the Deep, but the Alphas will likely push the advantage they have now and drive us back to the systems I mentioned. We are evacuating as fast as we possibly can and your next orders are to escort a fleet of refugees to Farseer in the Kursa system. Can you leave immediately?"`
			label eartkcanyouleave
			choice
				`	"What about the Free Worlds?"`
				`	"Yes sir."`
					accept
			`	"The Free Worlds say they are capable of managing their own evacuation efforts, but I will be letting you go serve as a Militia officer for a while after you return"`
				accept
	on complete
		payment 1000000
		conversation
			`	You receive a message from your communication system.`
			choice
				`	(Open the message)`
			`	It is 1.00M credits with a message attached; "Get back here as soon as possible." -Alzaga`
	npc accompany save
		personality timid escort
		government "Republic"
		fleet "Large Republic Refugee"

mission "Endgame Alpha 3.11"
	landing
	name "Report to New Iceland"
	description "Proceed with the utmost dispatch to New Iceland in the Kaus Borealis system."
	destination "New Iceland"
	source "Farseer"
	to offer
		has "Endgame Alpha 3.10: done"
	on offer
			accept
	to accept
		has "Endgame Alpha 3.10: done"
	on complete
		conversation
			`The hubbub in the city is truly extraordinary, with even the high ranking Naval officers looking tuckered out, but the exhaustion of the last few days doesn't stop the landing areas looking like an ant hill that has been recently abused. You have no idea where to find Admiral Alzaga.`
			choice
				`	(Snag the Nearest Person)`
					goto eartnitwosnag
				`	(Wander Around)`
					goto eartnitwowander
			label eartnitwosnag
			`	The first person you come within arms reach of is a brand new recruit who stumbles over his words as he is talking to you, he seems petrified that an officer would want to speak to him. "W-What do you want, Sir?"`
			choice 
				`	"Do you know where I can find Admiral Alzaga?"`
			"I have no clue s-sir, but I can take you to my unit leader if you would like sir."
			choice
				`	"Do that, then."`
				`	"Forget it."`
					goto eartnitwowander
			`	He starts off through the crowds, turning every few steps to make sure you are following. After a short walk the recruit points at a you lieutenant. "That's him sir, I have to get back to work soon or I'll catch it." You thank him for your time and tap the lieutenant on the shoulder. He spins around saying loudly, "What now-- Oh... How can I help you sir?" Snapping to attention and saluting in the process.`
			`	"Do you know where I can find Admiral Alzaga?" you ask.`
			`	He quickly replies without any hesitation as if he's gotten the question before: "I don't know personally but the Deputy Commander of Operations would, you'll find him in the Spaceport."`
				goto eartnitwoend
			label eartnitwowander
			`	You start to walk away from your ship into the busy crowds, and a young lieutenant catches your eye and comes over quickly. "How can I help you sir?" he asks cheerfully.`
			choice
				`	"Do you know where I can find Admiral Alzaga?"` 
			`	He quickly replies without any hesitation as if he's gotten the question before: "I don't know personally but the Deputy Commander of Operations would, you'll find him in the Spaceport."`
			label eartnitwoend

mission "Endgame Alpha 3.12"
	priority 
	name "Report to Admiral Alzaga"
	description "Report to Admiral Alzaga on New Argentina in the Vindemiatrix system to receive orders regarding defense preparation."
	destination "New Argentina"
	source "New Iceland"
	to offer
		has "Endgame Alpha 3.11: done"
	on offer
		event "EA alpha breakout timer four" 7
		conversation
			`	It is easy enough to find your way to the DCO's office, given that everything indoors is copiously labelled. After waiting for a few minutes in the queue of officers and NCOs in need of clarification or new orders, you finally gain your audience with the commander, an wizened admiral that looks like he can barely stand.`
			`	"Ah, the renowned Captain <last>," He says in a surprisingly clear voice (by his looks you expected little more than a dull creak) "What can I do for you today?"`
			choice
				`	"Where can I find Admiral Alzaga?"`
			`	"Oh, yes," he replies, "Admiral Alzaga told me to tell you when you came that he had travelled to New Argentina to organize the formation of a strong blockade in the system. Incidentally he has been placed in command of all the Navy operations against the Alphas and there is talk of his commanding a combined fleet including the Free Worlds. You should head to Vindemiatrix immediately."`
				accept
	on complete
		dialog `An aide is waiting for you outside your ship and tells you Alzaga is waiting in the spaceport.`
